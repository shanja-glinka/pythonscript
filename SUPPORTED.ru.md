# PythonScript: поддерживаемый поднабор

Документ описывает **текущий** поддерживаемый поднабор `.pjs` и `.js`, а также упрощения рантайма. Это не полноценный Python/JavaScript.

## `.pjs` (Python‑подобный поднабор)
- **Базовые типы**: числа, строки, булевы (`True/False`), `None`, списки, словари, индексация.
- **Инструкции**: `if/elif/else`, `for range(...)`, `while`, `try/except/finally`, `def`, `class`, `return`.
- **Операторы**: `+ - * / // % **`, сравнения `< > <= >= == !=`, логические `and/or/not`, тернарный `x if cond else y`, расширенные присваивания `+= -= *= /= //= %= **=`, проверки `in / not in`.
- **Срезы**: `arr[start:stop(:step)]` (step парсится; в JS‑выводе сейчас используется `slice(start, stop)`).
- **Вызовы/атрибуты**: `obj.attr`, `obj[idx]`, `obj.method(...)`, `len(x)` → `.length`, `list.append`, `list.pop`.
- **Строки**: обычные строки и упрощённые f‑строки (`f"Hello {name}"`). Нет экранирования `{{}}`, нет многострочных строк.
- **Функции**: аргументы с дефолтами, `*args` (rest). `**kwargs` парсится, но не поддержан в генерации.
- **Классы**: простые классы, методы, `__init__`; наследование не реализовано.
- **Не поддержано**: генераторы/async, декораторы, comprehensions, контекстные менеджеры, set/tuple, pattern matching, полноценные модули.

## `.js` (поднабор для js→pjs)
- **База**: `let/const/var`, литералы number/string/true/false/null, массивы, объекты.
- **Выражения**: унарные `! + -`, бинарные/логические `+ - * / % ** && || == === != !== < > <= >=`.
- **Доступы/вызовы**: `obj.prop`, `obj[idx]`, вызовы с аргументами.
- **Маппинги в `.pjs`**:
  - `console.log(...)` → `print(...)`
  - `arr.slice(a, b)` → `arr[a:b]`
  - `arr.includes(x)` → `x in arr`
  - `arr.push(x)` / `arr.pop()` → `append` / `pop`
- **Не поддержано**: import/export, корректный парсинг `if/for/while/try/...` (блоки пропускаются), template literals, деструктуризация, spread/rest в литералах, optional chaining, async/await.

## Рантайм и stdlib
- **Node**: запуск небезопасен по умолчанию; есть best‑effort sandbox через `--sandbox` и `--timeout`.
- **Browser**: выполнение через `new Function` или Web Worker (если доступен); DOM не эмулируется.
- **Встроенный stdlib**: `print`, `len`, `range` автоматически добавляются к сгенерированному JS. Это не Python runtime.

## Известные ограничения
- Неподдерживаемый синтаксис может превращаться в `UnknownExpression` / `IgnoredStatement`.
- Отрицательные индексы/срезы не нормализуются как в CPython.
- Генерация кода неидемпотентна и не сохраняет форматирование/комментарии.
